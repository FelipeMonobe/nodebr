general:
  branches:
    only:
      - backend
machine:
  services:
    - mysql
  environment:
    DATABASE_URL: mysql://ubuntu@localhost/circle_test
    NODE_ENV: test
  node:
    version: v6.9
test:
  override:
    - npm run test-cov
    - npm install -g codeclimate-test-reporter
    - codeclimate-test-reporter < coverage/lcov.info
  pre:
    - npm run knex -- migrate:latest
